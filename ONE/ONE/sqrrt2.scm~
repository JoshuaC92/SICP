#lang sicp

; As part of exercise 1.7 we need to define a new version of good-enough 
; which watches how guess chages between each iteration and when it becomes 
; a small enough change then it is accepted.

; good-enough needs to take 2 args now:
;   1. The current guess 
;   2. A new guess 

; The new good-enogh will:
;   1. Find the difference between the guess'
;   2. Find the percent change compared with the current guess
;   3. Compare this to a percentage
;   4. Return true if percent change is below this, else false

(define (square x)
    (* x x))


(define (good-enough? guess new-guess)
  (< (abs (/ (- guess new-guess) 
             new-guess))
     0.1))


(define (average x y)
  (/ (+ x y) 2))


(define (improve guess x)
  (average guess (/ x guess)))


(define (sqrt-iter guess x)
  (if (good-enough? guess (improve guess x)) 
      (improve guess)
      (sqrt-iter (improve guess x) x)))


(define (sqrt x)
  (sqrt-iter 1.0 x))
